/* static/css/styles.css
   LineAgeMap — consolidated stylesheet (NO FOOTER / NO SAMPLES PAGE RULES)

   Goals:
   - Single parchment system for ALL pages
   - One topbar system (center links + right actions)
   - Landing page hero + 3 preview cards grid (Tree/Timeline/Map)
   - Preserve tree canvas + map pin visuals

   Refactor:
   - Mobile-first layout rules
   - Desktop enhancements via min-width queries
*/

/* =========================================================
   Theme tokens (MOBILE FIRST)
   ========================================================= */
:root{
  color-scheme: light;

  --sans: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
  --serif: "Palatino Linotype","Book Antiqua",Palatino,"Iowan Old Style","Garamond","Georgia","Times New Roman",serif;

  /* Paper + ink (warmer, calmer, more romantic parchment) */
  --bg:   #EFE4D3;   /* base parchment */
  --bg-2: #F7EFE2;   /* lighter top wash */
  --ink:  rgba(44, 30, 18, 0.92);
  --ink-2:rgba(44, 30, 18, 0.72);
  --line: rgba(44, 30, 18, 0.14);

  /* Navbar */
  --nav-bg: rgba(242, 232, 214, 0.86);
  --nav-border: rgba(90, 60, 40, 0.18);
  --nav-hover: rgba(255,255,255,.35);

  /* Cards */
  --card-bg-a: rgba(255,255,255,0.52);
  --card-bg-b: rgba(255,255,255,0.22);
  --card-border: rgba(90, 60, 40, .20);

  /* Layout sizing (mobile-first) */
  --page-pad: 12px;
  --content-max: 1120px;

  /* Type */
  --brand-font: clamp(18px, 5.1vw, 22px);
  --hero-font: clamp(22px, 7.2vw, 44px);
  --sub-font:  clamp(14px, 3.5vw, 17px);

  /* Buttons */
  --btn-font: 13.5px;
  --btn-pad-y: 8px;
  --btn-pad-x: 12px;

  /* Tree (SVG) */
  --tree-link: rgba(64, 52, 38, 0.42);
  --tree-union-dot: rgba(64, 52, 38, 0.25);
  --tree-card-bg: rgba(255,255,255,0.72);
  --tree-card-stroke: rgba(64, 52, 38, 0.16);
  --tree-photo-ph: rgba(64, 52, 38, 0.08);
  --tree-photo-ring: rgba(64, 52, 38, 0.18);
  --tree-text-strong: rgba(40, 32, 24, 0.92);
  --tree-text-soft: rgba(40, 32, 24, 0.70);
}

/* =========================================================
   Base / parchment
   ========================================================= */
*{ box-sizing: border-box; }
html,body{ height:100%; }

body{
  margin:0;
  font-family: var(--serif);
  color: var(--ink);

  /* clean parchment base */
  background-color: var(--bg);

  /* soft vignette only */
  background-image:
    radial-gradient(1400px 1000px at 50% 45%,
      rgba(0,0,0,0) 62%,
      rgba(90, 60, 30, 0.14) 100%
    );

  background-attachment: fixed;
  position: relative; /* keep */
}

a{ color: inherit; }
img{ max-width:100%; height:auto; display:block; }

/* Paper texture overlay (IMPORTANT: behind content) */
body::after{
  content:"";
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 0;

  background-image: url("../img/paper-texture-light.jpg");
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;

  opacity: 0.4;
  mix-blend-mode: multiply;
  filter: contrast(1.10);
}

/* page wrapper */
main.page{
  max-width: var(--content-max);
  margin: 0 auto;
  padding: 16px var(--page-pad) 26px;
  position: relative;
  z-index: 2; /* above texture */
}

/* =========================================================
   Topbar (universal) — MOBILE FIRST
   Mobile: brand + right actions, hide center links (prevents clutter)
   Desktop: restore center links
   ========================================================= */
.topbar{
  position: sticky;
  top: 0;
  z-index: 1000;
  background: var(--nav-bg);
  backdrop-filter: blur(6px);
  border-bottom: 1px solid var(--nav-border);
}

.topbar-inner{
  max-width: var(--content-max);
  margin: 0 auto;
  padding: 10px var(--page-pad);
  display: grid;
  grid-template-columns: 1fr auto; /* mobile */
  align-items: center;
  gap: 10px;
}

.topbar-left{
  display: inline-flex;
  align-items: center;
  gap: 10px;
  min-width: 0;
}

.brandIcon{
  display: inline-flex;
  align-items: center;
  text-decoration: none;
}

.brandMark{
  width: 38px;
  height: 38px;
  border-radius: 14px;
  box-shadow: 0 10px 18px rgba(20, 12, 6, 0.10);
}

.brandTitle{
  font-family: var(--serif);
  font-weight: 900;
  letter-spacing: .2px;
  color: rgba(60, 40, 25, 0.92);
  text-decoration: none;
  font-size: var(--brand-font);
  line-height: 1;
  white-space: nowrap;
}

/* Mobile default: hide nav links */
.topbar-links{ display:none; }

.topbar-right{
  display: inline-flex;
  justify-content: flex-end;
  align-items: center;
  gap: 8px;
}

/* Buttons */
.btn{
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: var(--btn-pad-y) var(--btn-pad-x);
  border-radius: 999px;
  font-family: var(--serif);
  font-weight: 900;
  font-size: var(--btn-font);
  text-decoration: none;
  border: 1px solid rgba(90, 60, 40, 0.22);
  box-shadow: inset 0 1px 0 rgba(255,255,255,0.55);
  white-space: nowrap;
}

.btn.ghost{
  background: rgba(255,255,255,0.35);
  color: rgba(60,40,25,0.88);
}
.btn.primary{
  background: linear-gradient(180deg, rgba(214,170,90,0.95), rgba(176,128,58,0.95));
  color: rgba(35,22,12,0.92);
  border-color: rgba(120,80,40,0.35);
}

@media (hover:hover){
  .btn:hover{ filter: brightness(1.03); transform: translateY(-1px); }
}

/* Auth badge (kept) */
.authLinks{ display:flex; gap:8px; align-items:center; }
.userBadge{
  display: inline-flex;
  align-items: center;
  gap: 10px;
  padding: 7px 10px;
  border-radius: 999px;
  background: rgba(255,255,255,0.35);
  border: 1px solid rgba(90, 60, 40, 0.18);
  color: rgba(60,40,25,0.85);
}
.userBadge .dot{
  width: 8px;
  height: 8px;
  border-radius: 999px;
  background: rgba(176,128,58,0.95);
  box-shadow: 0 0 0 3px rgba(176,128,58,0.18);
}
.userBadge .email{
  font-weight: 900;
  font-size: 12px;
  opacity: .88;
  overflow:hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  max-width: 190px;
}
.userBadge .logoutLink{
  font-weight: 900;
  font-size: 12px;
  text-decoration: none;
  padding: 6px 10px;
  border-radius: 999px;
  border: 1px solid rgba(120,92,70,.22);
  background: rgba(110,80,58,.10);
}
@media (hover:hover){
  .userBadge .logoutLink:hover{ background: rgba(110,80,58,.18); }
}

.logoutLink{
  color: rgba(60,40,25,0.88);
  text-decoration: none;
  font-weight: 900;
}

/* =========================================================
   Landing (marketing homepage) — MOBILE FIRST
   main.landing > section.hero + section.previews + section.trust
   ========================================================= */
main.landing{
  max-width: var(--content-max);
  margin: 0 auto;
  padding: 18px var(--page-pad) 26px;
  position: relative;
  z-index: 2; /* above texture */
}

.hero{
  text-align: center;
  padding: 14px 0 10px;
}
.hero-logo{
  width: min(420px, 94%);
  height: auto;
  margin: 6px auto 10px;
  filter: drop-shadow(0 10px 16px rgba(20, 12, 6, 0.10));
}
.hero-title{
  margin: 8px auto 8px;
  font-family: var(--serif);
  font-weight: 900;
  font-size: var(--hero-font);
  line-height: 1.04;
  letter-spacing: .10px;
  color: rgba(80,54,38,.94);
  text-shadow:
    0 2px 0 rgba(255,255,255,.50),
    0 10px 20px rgba(60,40,25,.14);
}
.hero-subtitle{
  margin: 0 auto;
  max-width: 62ch;
  font-size: var(--sub-font);
  line-height: 1.5;
  color: rgba(43, 30, 20, .84);
}

/* ✅ Cards grid (mobile = 1 col) */
.previews{
  margin-top: 14px;
  display:grid;
  grid-template-columns: 1fr;
  gap: 12px;
  align-items: stretch;
}

/* card */
.preview-card{
  background: linear-gradient(180deg, var(--card-bg-a), var(--card-bg-b));
  border: 1px solid var(--card-border);
  border-radius: 16px;
  padding: 12px;
  position: relative;
  overflow: hidden;
  box-shadow:
    0 12px 26px rgba(0,0,0,.10),
    inset 0 1px 10px rgba(255,255,255,.55);
  display:flex;
  flex-direction: column;
}

/* subtle edge wear only on cards */
.preview-card::before{
  content:"";
  position:absolute;
  inset:0;
  pointer-events:none;
  background:
    radial-gradient(70% 55% at 12% 12%, rgba(0,0,0,.06), transparent 58%),
    radial-gradient(70% 55% at 88% 16%, rgba(0,0,0,.05), transparent 62%),
    radial-gradient(70% 55% at 14% 90%, rgba(0,0,0,.05), transparent 62%),
    radial-gradient(70% 55% at 90% 92%, rgba(0,0,0,.05), transparent 62%);
  opacity: .22;
}

.preview-title{
  font-family: var(--serif);
  text-align:left;
  margin: 2px 2px 10px;
  font-size: 20px;
  font-weight: 900;
  color: rgba(70,46,32,.92);
}

/* stable preview window */
.preview-body{
  flex: 1 1 auto;
  position: relative;
  min-height: 185px;
  border-radius: 12px;
  border: 1px solid rgba(70,45,25,0.12);
  background:
    radial-gradient(380px 220px at 35% 45%, rgba(120,80,40,0.10), rgba(120,80,40,0) 60%),
    radial-gradient(380px 220px at 70% 40%, rgba(90,60,30,0.08), rgba(90,60,30,0) 62%),
    linear-gradient(180deg, rgba(255,255,255,0.22), rgba(255,255,255,0.08));
  overflow: hidden;
}

/* link */
.preview-link{
  margin: 10px auto 2px;
  width: fit-content;
  display:inline-flex;
  align-items:center;
  justify-content:center;
  padding: 9px 12px;
  border-radius: 10px;
  text-decoration:none;
  font-family: var(--serif);
  font-size: 14px;
  font-weight: 800;
  color: rgba(43, 30, 20, .88);
  background: rgba(255,255,255,.35);
  border: 1px solid rgba(90, 60, 40, .18);
  box-shadow: inset 0 1px 6px rgba(20, 12, 6, 0.10);
}
@media (hover:hover){
  .preview-link:hover{ transform: translateY(-1px); }
}

/* Trust row (kept — NOT footer) */
.trust{
  margin-top: 14px;
  display:grid;
  grid-template-columns: 1fr;
  gap: 14px;
  text-align:center;
  padding-top: 6px;
}
.trust-item h3{
  margin: 8px 0 6px;
  font-family: var(--serif);
  font-size: 17px;
  font-weight: 900;
}
.trust-item p{
  margin: 0 auto;
  color: rgba(43,30,20,.75);
  font-size: 14px;
  line-height: 1.4;
  max-width: 48ch;
}
.trust-icon{ font-size: 22px; }

/* =========================================================
   Tree canvas
   ========================================================= */
#canvas{
  position: relative;
  margin-top: 0;
  border: 1px solid var(--line);
  border-radius: 14px;
  background:
    radial-gradient(900px 560px at 15% 10%, rgba(255,255,255,0.70), rgba(255,255,255,0.00)),
    radial-gradient(700px 520px at 80% 20%, rgba(176,204,196,0.22), rgba(255,255,255,0.00)),
    linear-gradient(180deg, rgba(255,255,255,0.25), rgba(255,255,255,0.10));
  overflow: hidden;
  height: auto;
  min-height: 340px;
  box-shadow: 0 14px 34px rgba(40,32,24,0.08);
}
#treeSvg{ width:100%; height:100%; display:block; }

/* SVG card shadow */
.tree-nodes rect{
  filter:
    drop-shadow(0 14px 26px rgba(0,0,0,0.20))
    drop-shadow(0 4px 10px rgba(0,0,0,0.12));
}

/* tools */
.fit-btn{
  position:absolute;
  top:10px;
  right:10px;
  z-index:6;
  border:1px solid var(--line);
  background: rgba(255,255,255,0.72);
  padding:8px 10px;
  border-radius:12px;
  font-size:13px;
  cursor:pointer;
  box-shadow: 0 10px 18px rgba(40,32,24,0.10);
  backdrop-filter: blur(6px);
}
.treeTools{
  position:absolute;
  top:10px;
  right:10px;
  z-index: 7;
  display:flex;
  flex-direction:column;
  gap: 10px;
}
.treeTools .fit-btn{ position: static; }

/* =========================================================
   Map panel + Pins
   ========================================================= */
.map-shell{
  max-width: 1440px;
  margin: 0 auto;
  padding: 18px var(--page-pad) 10px;
  position: relative;
  z-index: 2;
}
.map-panel{
  background: rgba(246,242,234,.85);
  border:1px solid rgba(122,79,60,.16);
  border-radius:24px;
  padding:14px;
  box-shadow:0 10px 26px rgba(0,0,0,.05);
}
.map-canvas{
  position:relative;
  width:100%;
  aspect-ratio:16/10; /* nicer on mobile */
  border-radius:18px;
  overflow:hidden;
  background: rgba(255,255,255,.35);
}
.map-bg{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  object-fit:cover;
  filter:saturate(.85) contrast(.95);
  opacity:.95;
}
.map-pins{ position:absolute; inset:0; }

.avatar-pin{
  position:absolute;
  transform: translate(-50%,-50%);
  display:flex;
  align-items:center;
  gap:10px;
  pointer-events:none;
}
.avatar-pin-img{
  width:40px;
  height:40px;
  border-radius:999px;
  object-fit:cover;
  border:3px solid rgba(255,255,255,.92);
  box-shadow:0 10px 18px rgba(0,0,0,.10);
}
.avatar-pin-label{
  background:rgba(255,255,255,.85);
  border:1px solid rgba(122,79,60,.14);
  border-radius:12px;
  padding:7px 9px;
  box-shadow:0 10px 18px rgba(0,0,0,.08);
  max-width:190px;
}
.avatar-pin-name{
  font-family:var(--sans);
  font-weight:800;
  font-size:12px;
  color:rgba(74,46,35,.92);
}
.avatar-pin-city{
  font-family:var(--sans);
  font-size:11px;
  color:rgba(74,46,35,.70);
  margin-top:3px;
}

/* =========================================================
   RESPONSIVE ENHANCEMENTS (min-width)
   ========================================================= */

/* slightly wider phones */
@media (min-width: 480px){
  :root{
    --page-pad: 14px;
    --btn-font: 14px;
    --btn-pad-y: 9px;
    --btn-pad-x: 14px;
  }

  .brandMark{ width:40px; height:40px; }
  #canvas{ min-height: 380px; }
  .preview-body{ min-height: 200px; }
}

/* tablet */
@media (min-width: 760px){
  :root{ --page-pad: 18px; }

  .userBadge .email{ max-width: 260px; display:inline; }

  main.landing{ padding: 22px var(--page-pad) 30px; }

  .trust{
    grid-template-columns: repeat(3, minmax(0, 1fr));
    gap: 20px;
    text-align:left;
  }
  .trust-item p{ margin: 0; max-width: none; }
}

/* desktop: restore center nav + 3 card columns */
@media (min-width: 900px){
  :root{ --page-pad: 22px; }

  .topbar-inner{
    grid-template-columns: 1fr auto 1fr;
    gap: 14px;
    padding: 12px var(--page-pad);
  }

  .topbar-links{
    display: inline-flex;
    justify-content: center;
    align-items: center;
    gap: 26px;
  }

  .topbar-links a{
    font-family: var(--serif);
    font-weight: 800;
    text-decoration: none;
    color: rgba(60, 40, 25, 0.78);
    padding: 8px 10px;
    border-radius: 12px;
  }

  @media (hover:hover){
    .topbar-links a:hover{ background: var(--nav-hover); }
  }

  .topbar-links a.is-active{
    color: rgba(60, 40, 25, 0.94);
    background: rgba(255, 255, 255, 0.45);
    border: 1px solid rgba(90, 60, 40, 0.18);
  }

  .previews{
    grid-template-columns: repeat(3, minmax(0, 1fr));
    gap: 16px;
  }

  .preview-title{ font-size: 22px; }
  .preview-body{ min-height: 210px; }

  .map-canvas{ aspect-ratio: 16/9; }
  .avatar-pin-img{ width:46px; height:46px; }
  .avatar-pin-label{ max-width:220px; padding:8px 10px; border-radius:14px; }
  .avatar-pin-name{ font-size:13px; }
  .avatar-pin-city{ font-size:12px; }
}

/* large desktop: tree becomes app-height */
@media (min-width: 1024px){
  #canvas{
    height: calc(100vh - 110px);
    min-height: 520px;
    border-radius: 16px;
  }
}

/* small screens: hide email earlier if needed */
@media (max-width: 820px){
  .userBadge .email{ display:none; }
}

/* ultra small */
@media (max-width: 360px){
  :root{
    --page-pad: 10px;
    --btn-font: 12.5px;
    --btn-pad-y: 7px;
    --btn-pad-x: 10px;
  }
  .brandMark{ width:34px; height:34px; border-radius: 13px; }
  #canvas{ min-height: 280px; }
}